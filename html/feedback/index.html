<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Feedback Center</title>
    <link rel="stylesheet" href="/assets/data/styles.css">

    <style>
      body {
        text-align: center;
        padding: 80px 20px;
        max-width: 800px;
        user-select: none;
        overflow: hidden;
      }
      a { margin-top: 0; }
      #home-link {
        position: fixed;
        top: 10px;
        left: 10px;
      }
      input, textarea {
        width: 100%;
        max-width: 600px;
        padding: 10px;
        font-size: 16px;
        border-radius: 6px;
        border: none;
        margin-top: 15px;
      }
      textarea {
        height: 150px;
        resize: none;
      }
      button {
        margin-top: 20px;
        padding: 12px 25px;
        font-size: 18px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        background-color: #007bff;
        color: #fff;
      }
      button:hover {
        background-color: #0056b3;
      }
      #status {
        margin-top: 20px;
        font-size: 16px;
      }
    </style>

    <script src="/assets/data/mobile.js"></script>
  </head>
  <body>
    <h1>The Feedback Center</h1>
    <p>want to report a bug, suggest an idea or spam gibberish? send a feedback!</p>
    <p style="color: #ff0">NOTE: if you want to ask a question, im more likely to respond if you DM me on <a href="//discordapp.com/users/878845118369636433/" draggable="false" target="_blank">Discord</a>.</p>

    <input type="text" id="name" placeholder="enter your name">
    <br>
    <textarea id="feedback" placeholder="type your feedback here"></textarea>
    <br>
    <button onclick="sendFeedback()">send feedback</button>
    <p id="status"></p>

    <script>
      const RATE_LIMIT_MS = 15000;

      function formatUTCDate(date) {
        const year = date.getUTCFullYear();
        const month = String(date.getUTCMonth() + 1).padStart(2, "0");
        const day = String(date.getUTCDate()).padStart(2, "0");
        const hours = String(date.getUTCHours()).padStart(2, "0");
        const minutes = String(date.getUTCMinutes()).padStart(2, "0");
        return `${year}-${month}-${day} ${hours}:${minutes} UTC`;
      }

      async function sendFeedback() {
        const nameInput = document.getElementById("name").value.trim();
        const feedback = document.getElementById("feedback").value.trim();
        const status = document.getElementById("status");

        if (!nameInput) {
          status.textContent = "‚ö†Ô∏è please enter your name";
          status.style.color = "orange";
          return;
        }

        if (!feedback) {
          status.textContent = "‚ö†Ô∏è please enter some feedback";
          status.style.color = "orange";
          return;
        }

        const lastSent = localStorage.getItem("last-feedback-time");
        const now = Date.now();

        if (lastSent && now - lastSent < RATE_LIMIT_MS) {
          const waitSec = Math.ceil((RATE_LIMIT_MS - (now - lastSent)) / 1000);
          status.textContent = `‚è≥ please wait ${waitSec}s before sending again`;
          status.style.color = "orange";
          return;
        }

        localStorage.setItem("last-feedback-time", now);

        const sender = nameInput;
        const timestamp = formatUTCDate(new Date());
        const message = `üì© feedback from **${sender}** at *${timestamp}*:\n${feedback}`;

        try {
          const response = await fetch("https://discord.com/api/webhooks/1407697096815022120/E9C9M11XoG3lLyuCYQzxkv5vUBn7VIOZRZ97V4XG_a6xZCfAgN0qgWnIE64Q-fEZnoY_", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ content: message })
          });

          if (response.ok) {
            status.textContent = "‚úÖ feedback sent successfully";
            status.style.color = "lightgreen";
            document.getElementById("feedback").value = "";
            document.getElementById("name").value = "";
          } else {
            status.textContent = "‚ùå failed to send feedback. try again later";
            status.style.color = "red";
          }
        } catch (err) {
          status.textContent = "‚ùå error sending feedback. check your connection";
          status.style.color = "red";
        }
      }
    </script>
  </body>
</html>